# โครงสร้างโปรเจกต์

my-blockchain/
├── contracts/
│   └── consensus.py
├── tests/
│   └── test_consensus.py
├── blockchain.py
├── node.py
├── requirements.txt
└── README.md


แน่นอน! ฉันจะอธิบายแต่ละส่วนของโค้ดและการทำงานของมันให้คุณเข้าใจง่าย ๆ:

## 1. blockchain.py
### คลาส Blockchain:
__init__: ฟังก์ชันนี้เป็นตัวสร้าง (constructor) ที่จะถูกเรียกเมื่อสร้างออบเจ็กต์ใหม่ของคลาส Blockchain มันจะเริ่มต้นบล็อกเชนด้วยการสร้างบล็อก genesis และตั้งค่าตัวแปรต่าง ๆ เช่น chain, current_transactions, nodes, และ ram_stakes
register_node: ฟังก์ชันนี้ใช้ในการลงทะเบียนโหนดใหม่ในเครือข่าย โดยรับที่อยู่ของโหนดและ RAM ที่ stake ไว้
new_block: ฟังก์ชันนี้ใช้ในการสร้างบล็อกใหม่ โดยรับ proof และ previous_hash เป็นพารามิเตอร์ และเพิ่มบล็อกใหม่ลงใน chain
new_transaction: ฟังก์ชันนี้ใช้ในการเพิ่มธุรกรรมใหม่ลงในรายการธุรกรรมปัจจุบัน โดยรับ sender, recipient, และ amount เป็นพารามิเตอร์
last_block: ฟังก์ชันนี้เป็น property ที่คืนค่าบล็อกสุดท้ายใน chain
hash: ฟังก์ชันนี้ใช้ในการสร้างแฮชของบล็อก โดยรับบล็อกเป็นพารามิเตอร์และคืนค่าแฮชของบล็อกนั้น
select_validator: ฟังก์ชันนี้ใช้ในการเลือก validator โดยสุ่มเลือกจากโหนดที่ stake RAM ไว้
validate_block: ฟังก์ชันนี้ใช้ในการตรวจสอบความถูกต้องของบล็อก
slash_validator: ฟังก์ชันนี้ใช้ในการลงโทษ validator ที่ทำผิดกฎ โดยการลบออกจากรายการโหนดและ ram_stakes
resolve_conflicts: ฟังก์ชันนี้ใช้ในการแก้ไขความขัดแย้งในบล็อกเชน โดยการใช้กลไกฉันทามติ
## 2. app.py
### การตั้งค่า Flask และการกำหนดเส้นทาง (routes):
/mine: เส้นทางนี้ใช้ในการสร้างบล็อกใหม่ โดยเลือก validator ตาม RAM ที่ stake และสร้างบล็อกใหม่ จากนั้นคืนค่าข้อมูลของบล็อกใหม่ที่ถูกสร้างขึ้น
/transactions/new: เส้นทางนี้ใช้ในการเพิ่มธุรกรรมใหม่ โดยรับข้อมูลธุรกรรมจากผู้ใช้และเพิ่มลงในบล็อกเชน จากนั้นคืนค่าข้อความที่บอกว่าธุรกรรมจะถูกเพิ่มในบล็อกใด
/nodes/register: เส้นทางนี้ใช้ในการลงทะเบียนโหนดใหม่ โดยรับที่อยู่ของโหนดและ RAM ที่ stake จากผู้ใช้ จากนั้นเพิ่มโหนดใหม่ลงในเครือข่ายและคืนค่าข้อความที่บอกว่าโหนดใหม่ถูกเพิ่มแล้ว
/nodes/resolve: เส้นทางนี้ใช้ในการแก้ไขความขัดแย้งในบล็อกเชน โดยการใช้กลไกฉันทามติและคืนค่าข้อความที่บอกว่าห่วงโซ่ของเราถูกแทนที่หรือเป็น authoritative
การทำงานโดยรวม:
การสร้างบล็อกใหม่: เมื่อมีการเรียก /mine ระบบจะเลือก validator ตาม RAM ที่ stake และสร้างบล็อกใหม่ จากนั้นคืนค่าข้อมูลของบล็อกใหม่
การเพิ่มธุรกรรม: เมื่อมีการเรียก /transactions/new ระบบจะรับข้อมูลธุรกรรมจากผู้ใช้และเพิ่มลงในบล็อกเชน จากนั้นคืนค่าข้อความที่บอกว่าธุรกรรมจะถูกเพิ่มในบล็อกใด
การลงทะเบียนโหนดใหม่: เมื่อมีการเรียก /nodes/register ระบบจะรับที่อยู่ของโหนดและ RAM ที่ stake จากผู้ใช้ จากนั้นเพิ่มโหนดใหม่ลงในเครือข่ายและคืนค่าข้อความที่บอกว่าโหนดใหม่ถูกเพิ่มแล้ว
การแก้ไขความขัดแย้ง: เมื่อมีการเรียก /nodes/resolve ระบบจะใช้กลไกฉันทามติในการแก้ไขความขัดแย้งในบล็อกเชนและคืนค่าข้อความที่บอกว่าห่วงโซ่ของเราถูกแทนที่หรือเป็น authoritative